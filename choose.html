<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šå¤©åƒä»€éº¼ï¼Ÿ - é¤å»³è½‰ç›¤å°ˆæ¥­ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-red': '#EF4444',
                        'primary-yellow': '#FBBF24',
                        'primary-blue': '#3B82F6',
                        'bg-light': '#DCEEFF', /* æ·ºè—è‰²èƒŒæ™¯ */
                    }
                }
            }
        }

        #wheel-container { position: relative; }

        /* æŒ‡é‡ï¼šç¢ºä¿ç²¾ç¢ºæŒ‡å‘ä¸­å¿ƒ */
        #pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #EF4444;
            z-index: 20;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        .spin-animation {
            /* ä½¿ç”¨æ›´åŠ æµæš¢çš„æ¸›é€Ÿæ›²ç·š */
            transition: transform 5s cubic-bezier(0.15, 0, 0.15, 1);
        }

        .highlight {
            animation: pulse-glow 1s infinite alternate;
        }

        @keyframes pulse-glow {
            from { transform: scale(1); filter: brightness(1); }
            to { transform: scale(1.1); filter: brightness(1.2); text-shadow: 0 0 10px rgba(239,68,68,0.5); }
        }
    </style>
</head>
<body class="bg-bg-light min-h-screen p-4 sm:p-8 font-sans">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-5xl font-extrabold text-primary-red drop-shadow-sm">
                ğŸ• ä»Šå¤©åƒä»€éº¼ï¼Ÿ
            </h1>
        </header>

        <section class="mb-8 p-6 bg-white rounded-xl shadow-xl border-4 border-primary-yellow">
            <label class="block text-lg font-bold text-gray-800 mb-2">ğŸœ è¼¸å…¥é¸é … (ä»¥é€—è™Ÿåˆ†éš”)</label>
            <textarea id="options-input" rows="2"
                class="w-full p-4 border-4 border-primary-blue rounded-lg text-lg focus:outline-none transition duration-200">
ç‰›è‚‰éºµ, ç¾©å¤§åˆ©éºµ, å£½å¸, æ¼¢å ¡, ç«é‹, æ²™æ‹‰, æ»·è‚‰é£¯, æŠ«è–©</textarea>
        </section>

        <main class="flex flex-col items-center">
            <div id="wheel-container" class="mb-8 w-80 h-80 sm:w-96 sm:h-96">
                <div id="pointer"></div>
                <svg id="wheel" viewBox="0 0 100 100" class="w-full h-full transform rounded-full shadow-2xl border-8 border-white bg-white spin-animation">
                </svg>
            </div>

            <div class="mb-8 min-h-[60px] flex items-center justify-center">
                <p id="result-text" class="text-3xl sm:text-4xl font-black text-gray-800 text-center"></p>
            </div>

            <button id="spin-button"
                class="px-16 py-5 text-3xl font-black text-primary-blue 
                       bg-primary-red border-4 border-primary-yellow 
                       rounded-full shadow-2xl shadow-primary-red/40 
                       ring-4 ring-primary-yellow/80 ring-offset-4 ring-offset-bg-light 
                       active:scale-95 transition duration-150 transform hover:scale-105 
                       disabled:opacity-50 disabled:cursor-not-allowed">
                ğŸ”¥ å•Ÿå‹•è½‰ç›¤ï¼
            </button>
        </main>
    </div>

    <script>
        const inputElement = document.getElementById('options-input');
        const wheelSvg = document.getElementById('wheel');
        const spinButton = document.getElementById('spin-button');
        const resultText = document.getElementById('result-text');

        const colors = ['#EF4444', '#FBBF24', '#3B82F6', '#10B981', '#EC4899', '#8B5CF6', '#F97316', '#06B6D4'];
        
        let options = [];
        let currentRotation = 0; // ç´€éŒ„ç´¯ç©çš„è§’åº¦
        let isSpinning = false;

        function drawWheel() {
            const inputText = inputElement.value.trim();
            options = inputText.split(',').map(item => item.trim()).filter(item => item.length > 0);
            
            // é‡ç½®ï¼šç•¶ä½¿ç”¨è€…æ›´æ”¹å…§å®¹æ™‚ï¼Œå°‡è½‰ç›¤æ­¸é›¶ï¼Œé¿å…ç¬¬ä¸€æ¬¡è½‰å‹•ç•°å¸¸
            currentRotation = 0;
            wheelSvg.style.transition = 'none'; // æš«æ™‚é—œé–‰å‹•ç•«ä»¥é€²è¡Œé‡ç½®
            wheelSvg.style.transform = 'rotate(0deg)';
            
            if (options.length < 2) {
                spinButton.disabled = true;
                resultText.textContent = "è«‹è‡³å°‘è¼¸å…¥å…©å€‹é¸é …";
                return;
            }

            spinButton.disabled = false;
            wheelSvg.innerHTML = '';
            const anglePerOption = 360 / options.length;

            options.forEach((option, i) => {
                const startAngle = i * anglePerOption;
                const endAngle = (i + 1) * anglePerOption;
                
                const x1 = 50 + 50 * Math.cos(Math.PI * (startAngle - 90) / 180);
                const y1 = 50 + 50 * Math.sin(Math.PI * (startAngle - 90) / 180);
                const x2 = 50 + 50 * Math.cos(Math.PI * (endAngle - 90) / 180);
                const y2 = 50 + 50 * Math.sin(Math.PI * (endAngle - 90) / 180);

                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                path.setAttribute('d', `M 50 50 L ${x1} ${y1} A 50 50 0 ${anglePerOption > 180 ? 1 : 0} 1 ${x2} ${y2} Z`);
                path.setAttribute('fill', colors[i % colors.length]);
                path.setAttribute('stroke', 'white');
                path.setAttribute('stroke-width', '0.5');
                wheelSvg.appendChild(path);

                const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                const textAngle = startAngle + anglePerOption / 2;
                const tx = 50 + 35 * Math.cos(Math.PI * (textAngle - 90) / 180);
                const ty = 50 + 35 * Math.sin(Math.PI * (textAngle - 90) / 180);
                
                text.setAttribute('x', tx);
                text.setAttribute('y', ty);
                text.setAttribute('fill', 'white');
                text.setAttribute('font-size', options.length > 10 ? '3' : '4');
                text.setAttribute('font-weight', 'bold');
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('transform', `rotate(${textAngle}, ${tx}, ${ty})`);
                text.textContent = option;
                wheelSvg.appendChild(text);
            });
        }

        function spin() {
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            resultText.textContent = "é‹å‹¢æŠ½å–ä¸­...";
            resultText.classList.remove('highlight', 'text-primary-red');

            // é‡æ–°å•Ÿå‹•å‹•ç•«æ•ˆæœ
            wheelSvg.style.transition = 'transform 5s cubic-bezier(0.15, 0, 0.15, 1)';

            // å¢åŠ éš¨æ©Ÿæ—‹è½‰è§’åº¦ (è‡³å°‘ 5 åœˆ + éš¨æ©Ÿè§’åº¦)
            const randomExtra = Math.floor(Math.random() * 360);
            currentRotation += (1800 + randomExtra); 
            
            wheelSvg.style.transform = `rotate(${currentRotation}deg)`;

            // ç›£è½å‹•ç•«çµæŸ
            const onTransitionEnd = () => {
                isSpinning = false;
                spinButton.disabled = false;

                // ç²¾ç¢ºè¨ˆç®—çµæœï¼š
                // 1. å–å¾—ç¸½è§’åº¦é™¤ä»¥ 360 çš„é¤˜æ•¸
                const actualRotation = currentRotation % 360;
                // 2. ç”±æ–¼è½‰ç›¤æ˜¯é †æ™‚é‡è½‰ï¼ŒæŒ‡é‡ä½ç½®ç›¸å°æ–¼è½‰ç›¤æ˜¯é€†æ™‚é‡ç®—å›å»
                const anglePerOption = 360 / options.length;
                const winningIndex = Math.floor(((360 - actualRotation % 360) % 360) / anglePerOption);
                
                const winner = options[winningIndex];
                resultText.innerHTML = `å°±æ˜¯å®ƒäº†ï¼š<span class="text-primary-red underline">${winner}</span>ï¼`;
                resultText.classList.add('highlight');
                
                // ç§»é™¤ç›£è½å™¨é¿å…é‡è¤‡è§¸ç™¼
                wheelSvg.removeEventListener('transitionend', onTransitionEnd);
            };

            wheelSvg.addEventListener('transitionend', onTransitionEnd);
        }

        inputElement.addEventListener('input', drawWheel);
        spinButton.addEventListener('click', spin);
        
        // åˆå§‹ç¹ªè£½
        drawWheel();
    </script>
</body>
</html>

